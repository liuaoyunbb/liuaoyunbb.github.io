---
title: Java性能调优概述
date: 2018-08-01 12:47:43
tags:
    - 读书笔记
    - 性能优化
    - Java
---
&#160; &#160; &#160; &#160; 最近在读《Java程序性能优化》，想通过阅读本书，了解Java程序性能的瓶颈，程序优化方法、技巧和思想，从而在工作中能有定位问题的思路和解决问题的方法。
<!--more-->
### Java性能调优概述
#### 看懂程序性能
一般来说，程序的性能通过以下几个方面来表现：
- 执行速度，程序的反映是否迅速，响应是不是够快；
- 内存分配，内存分配是否合理，是否过多地消耗内存或者存在内存泄露；
- 启动时间，程序从运行到可以正常处理业务需要多长时间；
- 负载承受压力，当系统压力上升时，系统的执行速度，响应时间的上升曲线是否平缓。
#### 性能的参考指标
可用于定量测评的性能指标有：
- 执行时间:一段代码从开始运行到运行结束，所使用的时间；
- CPU时间:函数或者线程占用CPU的时间；
- 内存分配:程序在运行时占用的内存空间；
- 磁盘吞吐量:每秒磁盘 I/O 的流量，即磁盘写入加上读出的数据的大小；
- 网络吞吐量:描述网络的使用情况(字节/秒)；
- 响应时间:系统对事件做出的响应时间，响应时间越短，性能越好。
#### 性能瓶颈
根据应用的特点不同，任何计算机资源都有可能成为系统瓶颈，其中，最有可能成为系统性能瓶颈的计算资源如下：
- 磁盘I/O:由于磁盘IO读写的速度比内存慢很多，程序在运行过程中，如果需要等待磁盘IO完成，那么低效的IO操作会拖累整个系统；
- 网络I/O:由于网络环境的不确定性，网络IO可能比本地磁盘IO更慢，很可能成为系统瓶颈;
- CPU:对计算资源要就较高的应用，长时间、不间断地占用CPU资源，那么对CPU的争夺可能导致性能问题;
- 异常:对Java程序而言，异常的捕获和处理是非常消耗资源的，如果程序高频率地进行异常处理，则整体性能便会有明显下降;
- 数据库:海量数据的读写操作是相当费时的，容易成为性能瓶颈;
- 锁竞争:对高并发程序而言，如果存在激烈的锁竞争，将会增加线程上下切换的开销;
- 内存:一般是程序设计不合理导致的。
#### 性能调优的层次
##### 1. 设计调优
设计调优对系统性能的影响是最大的，代码优化、JVM优化都是对系统微观层面上的"量"的优化，而设计优化是宏观层面的"质"的优化。
一个良好的设计可以规避很多潜在的性能问题，如果设计层考虑不周，留下太多问题隐患，那么无法通过代码层进行补救。
##### 2. 代码调优
代码优化是对系统性能产生最直接影响的方法，代码优化涉及许多编码技巧，所以同一功能的不同实现可能在性能上相差好几个数量级。所以，开发人员需要熟练正确使用API或类库，对算法数据结构灵活使用，注意代码的重构。
##### 3. JVM调优
JVM调优通常在开发后期进行。JVM的各项参数将会直接影响Java程序的性能，比如，JVM堆大小，垃圾回收策略等。
##### 4. 数据库调优
对数据库的调优主要是三部分：
1. 在应用层面对数据库操作语句进行优化；  
在应用层优化数据库操作，涉及大量的编码技巧，主要是检查是否有不合理的操作语句并优化。
2. 对数据库进行优化；  
建立良好的表结构，合理的分库分表策略，合理使用索引等。
3. 选择合适的数据库软件。
#### 系统优化注意事项
优化过程往往伴随着风险，可能会引入新的bug，在进行优化前，必须有明确的已知问题和性能目标，清楚优化的对象和最终目的。
通过性能监控和统计工具，观测目标是否已达到，不要盲目地进行调整。





